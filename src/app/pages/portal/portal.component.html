<div class="container">
  <div class="container-children">
    <div class="main-logo">
      <img src="../../../assets/logo-samar.png" alt="logo-samar"></div>
    <span class="bem-vindo-texto">Seja bem vindo à rede hospitalar Samar, <br>por favor preencha corretamente os dados para usar a rede WI-FI.</span>

    <form [formGroup]="cadastroPortalForm" (ngSubmit)="onSubmit()" class="formulario" *ngIf="!successMessage">
      <mat-form-field class="form-field nome" appearance="outline">
        <mat-label class="nome-label">Nome</mat-label>
        <input matInput formControlName="nome" placeholder="Seu primeiro nome">
        <mat-error *ngIf="f['nome'].hasError('required')">Nome é obrigatório.</mat-error>
        <mat-error *ngIf="f['nome'].hasError('minlength') || f['nome'].hasError('maxlength')">Nome deve ter entre 2 e 50 caracteres.</mat-error>
      </mat-form-field>

      <mat-form-field class="form-field sobrenome" appearance="outline">
        <mat-label class="sobrenome-label">Sobrenome</mat-label>
        <input matInput formControlName="sobrenome" placeholder="Seu sobrenome completo">
        <mat-error *ngIf="f['sobrenome'].hasError('required')">Sobrenome é obrigatório.</mat-error>
        <mat-error *ngIf="f['sobrenome'].hasError('minlength') || f['sobrenome'].hasError('maxlength')">Sobrenome deve ter entre 2 e 50 caracteres.</mat-error>
      </mat-form-field>

      <mat-form-field class="form-field email" appearance="outline">
        <mat-label class="email-label">E-mail</mat-label>
        <input matInput type="email" formControlName="email" placeholder="seu.email@exemplo.com">
        <mat-error *ngIf="f['email'].hasError('required')">Email é obrigatório.</mat-error>
        <mat-error *ngIf="f['email'].hasError('email')">Formato de email inválido.</mat-error>
      </mat-form-field>

      <mat-form-field class="form-field telefone" appearance="outline">
        <mat-label class="telefone-label">Telefone</mat-label>
        <input matInput type="tel" formControlName="telefone" placeholder="(XX) XXXXX-XXXX">
         <mat-error *ngIf="f['telefone'].hasError('required')">Telefone é obrigatório.</mat-error>
         <mat-error *ngIf="f['telefone'].hasError('pattern')">Formato de telefone inválido.</mat-error>
      </mat-form-field>

      <div class="form-field terms-checkbox">
        <mat-checkbox formControlName="acceptTou" color="primary">
          Eu li e aceito os <a href="/termos-de-uso-portal" target="_blank">Termos de Uso</a> e a <a href="/politica-de-privacidade-portal" target="_blank">Política de Privacidade</a>.
        </mat-checkbox>
        <mat-error *ngIf="f['acceptTou'].hasError('required') && (f['acceptTou'].touched || cadastroPortalForm)" class="tou-error">
          Você deve aceitar os termos.
        </mat-error>
      </div>

      <button mat-raised-button color="accent" class="btn-enviar" type="submit" [disabled]="isLoading || !cadastroPortalForm.valid">
        <span *ngIf="isLoading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        {{ isLoading ? 'Enviando...' : 'Conectar à Rede Wi-Fi' }}
      </button>

      <div *ngIf="erro && !isLoading" class="error-message-box alert alert-danger mt-3">
        {{erro}}
      </div>
    </form>

    <div *ngIf="successMessage" class="success-message-box alert alert-success mt-3">
      <h3>{{successMessage}}</h3>
      <p *ngIf="originalRedirectUrl">Você será redirecionado para: {{originalRedirectUrl}}</p>
      <p *ngIf="!originalRedirectUrl">Você já pode começar a navegar!</p>
       <div class="spinner-border text-primary mt-2" role="status" *ngIf="originalRedirectUrl">
        <span class="visually-hidden">Redirecionando...</span>
      </div>
    </div>

  </div>
</div>
